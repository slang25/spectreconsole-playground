<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Spectre.Console Playground</title>
    <base href="/" />

    <!-- Tailwind CSS -->
    <link href="css/app.css" rel="stylesheet" />

    <!-- Critical CSS for skeleton loading state (prevents FOUC and provides seamless transition) -->
    <style>
        /* CSS Variables for theming - must match app.css */
        :root {
            --skeleton-bg: white;
            --skeleton-header-bg: rgba(255, 255, 255, 0.95);
            --skeleton-header-border: oklch(92.2% 0 0);
            --skeleton-panel-header-bg: oklch(97% 0 0);
            --skeleton-panel-border: oklch(92.2% 0 0);
            --skeleton-text: oklch(55.6% 0 0);
            --skeleton-resizer: oklch(87% 0 0);
            --skeleton-editor-bg: #fffffe;
            --skeleton-terminal-panel-bg: white;
            --skeleton-terminal-frame: oklch(26.9% 0 0);
            --skeleton-terminal-frame-border: rgba(115, 115, 115, 0.1);
            --skeleton-terminal-inner: #1e1e1e;
            --skeleton-dot-1: rgba(180, 83, 9, 0.6);
            --skeleton-dot-2: rgba(217, 119, 6, 0.6);
            --skeleton-dot-3: rgba(245, 158, 11, 0.6);
            --skeleton-dot-border: rgba(217, 119, 6, 1);
            --skeleton-logo-gradient-start: oklch(0.577 0.245 211.903);
            --skeleton-logo-gradient-end: oklch(0.577 0.245 226.903);
        }
        .dark {
            --skeleton-bg: oklch(20.5% 0 0);
            --skeleton-header-bg: rgba(30, 30, 30, 0.95);
            --skeleton-header-border: oklch(26.9% 0 0);
            --skeleton-panel-header-bg: oklch(26.9% 0 0);
            --skeleton-panel-border: oklch(26.9% 0 0);
            --skeleton-text: oklch(70.8% 0 0);
            --skeleton-resizer: oklch(43.9% 0 0);
            --skeleton-editor-bg: #1e1e1e;
            --skeleton-terminal-panel-bg: oklch(20.5% 0 0);
            --skeleton-terminal-frame: oklch(26.9% 0 0);
            --skeleton-terminal-frame-border: rgba(115, 115, 115, 0.1);
            --skeleton-terminal-inner: #1e1e1e;
            --skeleton-dot-1: rgba(180, 83, 9, 0.6);
            --skeleton-dot-2: rgba(217, 119, 6, 0.6);
            --skeleton-dot-3: rgba(245, 158, 11, 0.6);
            --skeleton-dot-border: rgba(217, 119, 6, 1);
            --skeleton-logo-gradient-start: oklch(0.704 0.191 206.479);
            --skeleton-logo-gradient-end: oklch(0.704 0.191 221.479);
        }

        /* Skeleton layout */
        .skeleton-wrapper {
            display: flex;
            flex-direction: column;
            height: 100vh;
            background: var(--skeleton-bg);
        }

        /* Skeleton header */
        .skeleton-header {
            position: sticky;
            top: 0;
            height: 64px;
            z-index: 50;
            border-bottom: 1px solid var(--skeleton-header-border);
            background: var(--skeleton-header-bg);
            backdrop-filter: blur(8px);
        }
        .skeleton-header-content {
            max-width: 98rem;
            margin: 0 auto;
            padding: 0 1rem;
            height: 64px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        @media (min-width: 640px) {
            .skeleton-header-content {
                padding: 0 1.5rem;
            }
        }
        @media (min-width: 1024px) {
            .skeleton-header-content {
                padding: 0 2rem;
            }
        }
        .skeleton-header-left {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .skeleton-logo-link {
            display: flex;
            align-items: center;
        }
        .skeleton-logo-svg {
            width: 40px;
            height: 40px;
            margin-right: 0.75rem;
            flex-shrink: 0;
            fill: oklch(0.505 0.213 215.000);
            display: none;
        }
        @media (min-width: 768px) {
            .skeleton-logo-svg {
                display: block;
            }
        }
        .dark .skeleton-logo-svg {
            fill: oklch(0.637 0.237 209.055);
            opacity: 0.9;
        }
        .skeleton-logo-text {
            font-size: 1.25rem;
            font-weight: bold;
            background: linear-gradient(to right, var(--skeleton-logo-gradient-start), var(--skeleton-logo-gradient-end));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        @media (min-width: 1024px) {
            .skeleton-logo-text {
                font-size: 1.5rem;
            }
        }
        .skeleton-badge {
            font-size: 0.75rem;
            font-weight: bold;
            font-family: ui-monospace, monospace;
            padding: 0.25rem 0.75rem;
            border-radius: 2px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            background: #fbbf24;
            color: #1f2937;
            border: 2px solid #1f2937;
            box-shadow: inset -2px -2px 0 0 #b45309, inset 2px 2px 0 0 #fde68a, 4px 4px 0 0 #1f2937;
        }
        .dark .skeleton-badge {
            background: #facc15;
            border-color: #fef3c7;
            box-shadow: inset -2px -2px 0 0 #a16207, inset 2px 2px 0 0 #fef08a, 4px 4px 0 0 #fef3c7;
        }
        .skeleton-theme-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            padding: 0.5rem;
            border-radius: 6px;
            background: transparent;
            border: none;
            cursor: pointer;
            color: oklch(43.9% 0 0);
        }
        .dark .skeleton-theme-btn {
            color: oklch(70.8% 0 0);
        }
        .skeleton-theme-btn svg {
            width: 20px;
            height: 20px;
        }
        .skeleton-icon-sun {
            display: none;
        }
        .skeleton-icon-moon {
            display: block;
        }
        .dark .skeleton-icon-sun {
            display: block;
        }
        .dark .skeleton-icon-moon {
            display: none;
        }

        /* Skeleton main content */
        .skeleton-main {
            flex: 1;
            overflow: hidden;
            display: flex;
        }

        /* Editor panel skeleton */
        .skeleton-editor-panel {
            width: 50%;
            min-width: 200px;
        }
        .skeleton-panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.5rem 1rem;
            font-size: 13px;
            background: var(--skeleton-panel-header-bg);
            border-bottom: 1px solid var(--skeleton-panel-border);
            color: var(--skeleton-text);
        }
        .skeleton-panel-header-left {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .skeleton-select {
            padding: 5px 8px;
            border-radius: 3px;
            font-size: 13px;
            background: var(--skeleton-panel-header-bg);
            color: var(--skeleton-text);
            border: 1px solid var(--skeleton-panel-border);
        }
        .skeleton-run-btn {
            padding: 6px 16px;
            border-radius: 3px;
            font-size: 13px;
            color: white;
            background: #0e639c;
            border: none;
        }
        .skeleton-editor-content {
            flex: 1;
            overflow: hidden;
            background: var(--skeleton-editor-bg);
        }

        /* Resizer skeleton */
        .skeleton-resizer {
            width: 6px;
            flex-shrink: 0;
            background: var(--skeleton-resizer);
        }

        /* Terminal panel skeleton */
        .skeleton-terminal-panel {
            flex: 1;
            min-width: 200px;
            display: flex;
            flex-direction: column;
            background: var(--skeleton-terminal-panel-bg);
        }
        .skeleton-terminal-header-btns {
            display: flex;
            gap: 0.5rem;
        }
        .skeleton-stop-btn {
            padding: 6px 12px;
            border-radius: 3px;
            font-size: 13px;
            color: white;
            background: #a11;
            border: none;
        }
        .skeleton-clear-btn {
            padding: 6px 12px;
            border-radius: 3px;
            font-size: 13px;
            background: var(--skeleton-panel-header-bg);
            color: var(--skeleton-text);
            border: 1px solid var(--skeleton-panel-border);
        }
        .skeleton-terminal-content {
            flex: 1;
            overflow: hidden;
        }
        .skeleton-terminal-frame {
            display: flex;
            flex-direction: column;
            flex: 1;
            margin: 0.5rem;
            padding: 0.25rem;
            border-radius: 0.75rem;
            background: var(--skeleton-terminal-frame);
            border: 1px solid var(--skeleton-terminal-frame-border);
            overflow: hidden;
        }
        .skeleton-terminal-dots {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
        }
        .skeleton-dot {
            width: 10px;
            height: 10px;
            border-radius: 3px;
            border: 1px solid var(--skeleton-dot-border);
        }
        .skeleton-dot-1 { background: var(--skeleton-dot-1); }
        .skeleton-dot-2 { background: var(--skeleton-dot-2); }
        .skeleton-dot-3 { background: var(--skeleton-dot-3); }
        .skeleton-terminal-inner {
            flex: 1;
            margin: 0 0.5rem 0.5rem;
            border-radius: 0.5rem;
            background: var(--skeleton-terminal-inner);
        }

        /* Loading overlay on top of skeleton */
        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            z-index: 1000;
        }
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-top-color: #0e639c;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 16px;
        }
        .loading-text {
            font-size: 14px;
            opacity: 0.9;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <script>
        // Dark mode initialization (matching main docs site)
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }

        // Listen for theme messages from parent window
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'theme') {
                if (event.data.dark) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
                // Notify Monaco editor of theme change
                if (window.updateMonacoTheme) {
                    window.updateMonacoTheme(event.data.dark);
                }
            }
        });
    </script>
    <div id="app">
        <!-- Skeleton layout that matches the final playground appearance -->
        <div class="skeleton-wrapper">
            <!-- Header skeleton -->
            <header class="skeleton-header">
                <div class="skeleton-header-content">
                    <div class="skeleton-header-left">
                        <div class="skeleton-logo-link">
                            <svg xmlns="http://www.w3.org/2000/svg" class="skeleton-logo-svg" viewBox="0 0 1270.000000 1270.000000" preserveAspectRatio="xMidYMid meet">
                                <g transform="translate(0.000000,1270.000000) scale(0.100000,-0.100000)">
                                    <path d="M799 10610 c-199 -48 -354 -191 -414 -383 l-25 -78 0 -3084 0 -3084 25 -79 c45 -141 155 -270 289 -335 124 -61 -80 -57 2819 -57 l2646 0 5 -43 c3 -23 8 -71 11 -105 13 -137 88 -334 179 -471 57 -85 187 -219 247 -254 25 -15 76 -34 112 -43 87 -22 163 -7 246 46 120 78 195 211 234 411 l23 124 14 -55 c63 -263 172 -511 326 -741 94 -142 229 -291 313 -348 272 -185 583 -197 750 -30 66 67 84 109 89 215 4 90 4 91 -51 230 -108 276 -137 477 -122 868 l7 196 77 0 c55 0 118 -11 229 -39 l154 -38 50 -84 c103 -172 221 -427 277 -599 38 -120 70 -274 86 -412 8 -75 21 -155 29 -178 37 -106 117 -199 220 -253 51 -26 202 -35 283 -17 83 18 193 97 268 192 157 199 256 485 286 825 11 122 6 524 -7 583 -5 24 -1 26 62 43 64 16 67 16 80 0 39 -50 109 -215 149 -351 25 -85 55 -174 67 -199 73 -156 261 -206 441 -117 65 32 110 70 159 135 128 169 178 414 157 764 -8 143 -38 350 -55 376 -2 4 7 25 22 46 77 112 168 344 200 504 l16 86 87 28 c188 60 391 170 498 269 132 122 183 230 183 383 0 71 -5 98 -24 138 -24 52 -82 112 -138 141 -52 28 -205 30 -378 5 -80 -11 -179 -23 -220 -27 l-75 -6 -29 56 c-33 65 -137 182 -211 236 -75 55 -156 94 -382 181 -110 43 -221 87 -245 100 -54 27 -92 69 -125 138 -25 52 -26 59 -20 180 4 69 16 200 26 291 52 430 53 809 5 1170 -54 405 -249 740 -569 979 -136 102 -297 190 -419 231 l-36 12 0 433 c0 433 0 434 -25 512 -52 167 -171 292 -341 360 l-69 28 -4215 2 c-2318 0 -4231 -3 -4251 -7z m8363 -1476 c417 -53 735 -193 962 -423 98 -98 155 -175 210 -282 84 -160 117 -292 141 -559 28 -313 17 -684 -30 -1025 -9 -60 -18 -164 -22 -230 -10 -208 22 -314 136 -452 76 -91 124 -118 391 -218 307 -116 377 -155 450 -249 23 -31 41 -58 39 -60 -2 -2 -47 8 -99 21 -131 35 -268 36 -360 3 -132 -47 -248 -116 -364 -218 -163 -143 -516 -488 -703 -687 -350 -372 -504 -514 -701 -644 -348 -231 -878 -408 -1322 -442 -409 -31 -796 45 -1059 208 -111 69 -249 210 -292 298 -32 65 -34 76 -33 165 1 104 23 178 85 287 75 131 137 194 430 441 181 152 251 295 250 511 -1 152 -16 223 -117 560 -35 117 -61 217 -58 222 3 5 20 9 38 9 55 0 217 31 261 50 53 23 103 73 132 131 43 88 56 187 59 437 2 266 -1 258 91 292 108 40 254 21 330 -45 35 -30 35 -32 53 -170 41 -311 106 -484 206 -546 48 -29 168 -48 381 -59 188 -10 432 -1 548 20 76 14 206 56 266 86 64 32 122 101 144 170 15 49 17 82 12 253 -5 198 -27 398 -52 482 -42 146 -125 221 -290 265 -57 15 -108 19 -268 19 l-197 0 0 45 c0 120 -37 255 -82 300 -76 77 -210 5 -291 -157 -31 -60 -67 -184 -67 -229 0 -27 -6 -34 -41 -50 -65 -29 -159 -98 -195 -144 -34 -43 -67 -119 -79 -181 l-6 -35 -57 28 c-114 57 -270 58 -379 2 -61 -31 -70 -21 -49 54 33 118 16 442 -29 536 -38 79 -114 84 -188 12 -68 -66 -136 -230 -137 -330 l0 -29 -61 7 c-34 3 -93 6 -131 6 l-69 0 6 48 c14 97 56 282 84 368 155 475 486 821 963 1008 108 42 308 94 430 110 62 9 124 17 138 20 76 11 479 5 592 -10z m-7029 -78 c18 -8 261 -243 569 -552 582 -584 560 -559 543 -651 -6 -33 -69 -101 -523 -557 -553 -554 -564 -564 -644 -551 -89 15 -151 110 -128 198 10 37 65 95 463 495 l452 452 -472 473 c-414 414 -472 477 -478 510 -25 132 98 235 218 183z m7169 -1405 c164 -57 201 -136 234 -502 37 -414 9 -486 -212 -558 -155 -50 -298 -64 -579 -57 -249 6 -398 23 -439 50 -95 62 -177 346 -180 621 -1 135 0 142 28 203 50 109 148 179 304 218 149 37 329 53 567 50 191 -2 216 -4 277 -25z m-2002 -174 c95 -34 118 -52 152 -114 52 -94 63 -159 62 -368 -1 -358 -44 -479 -187 -520 -146 -42 -612 -65 -727 -36 -153 38 -196 98 -226 316 -16 120 -31 487 -21 527 9 35 89 121 140 151 99 58 228 76 522 73 200 -2 214 -3 285 -29z m-1604 -443 c45 -33 67 -70 71 -121 5 -59 -25 -117 -77 -147 -35 -21 -47 -21 -980 -24 -520 -2 -964 0 -988 3 -57 8 -116 60 -130 115 -19 75 12 146 78 182 34 17 75 18 1017 16 974 -3 982 -3 1009 -24z m5329 -2140 c66 -7 173 -14 237 -14 103 0 146 5 247 26 24 5 24 5 18 -64 -15 -159 -89 -371 -180 -515 l-43 -68 -57 113 c-72 145 -160 261 -318 422 l-126 128 51 -7 c28 -3 105 -13 171 -21z m-812 -652 c53 -41 140 -115 193 -165 96 -91 224 -231 224 -245 0 -5 -30 -18 -67 -30 -79 -25 -305 -84 -308 -80 -1 2 -12 53 -24 113 -28 135 -70 268 -127 402 -24 57 -44 106 -44 109 0 9 43 -20 153 -104z m-1173 -560 c-9 -4 -271 61 -315 78 -29 11 -28 12 79 55 59 24 111 46 114 49 3 3 33 -36 67 -87 34 -50 59 -93 55 -95z"></path>
                                </g>
                            </svg>
                            <span class="skeleton-logo-text">Spectre.Console</span>
                        </div>
                        <span class="skeleton-badge">Playground</span>
                    </div>
                    <button class="skeleton-theme-btn">
                            <!-- Sun icon - shown in dark mode -->
                            <svg class="skeleton-icon-sun" width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                            </svg>
                            <!-- Moon icon - shown in light mode -->
                            <svg class="skeleton-icon-moon" width="20" height="20" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                            </svg>
                        </button>
                </div>
            </header>

            <!-- Main content skeleton -->
            <main class="skeleton-main">
                <!-- Editor panel -->
                <div class="skeleton-editor-panel">
                    <div class="skeleton-panel-header">
                        <div class="skeleton-panel-header-left">
                            <span>Code Editor</span>
                            <select class="skeleton-select" disabled>
                                <option>Examples...</option>
                            </select>
                        </div>
                        <button class="skeleton-run-btn" disabled>Run</button>
                    </div>
                    <div class="skeleton-editor-content"></div>
                </div>

                <!-- Resizer -->
                <div class="skeleton-resizer"></div>

                <!-- Terminal panel -->
                <div class="skeleton-terminal-panel">
                    <div class="skeleton-panel-header">
                        <span>Terminal Output</span>
                        <div class="skeleton-terminal-header-btns">
                            <button class="skeleton-stop-btn" disabled style="visibility: hidden;">Stop</button>
                            <button class="skeleton-clear-btn" disabled>Clear</button>
                        </div>
                    </div>
                    <div class="skeleton-terminal-content">
                        <div class="skeleton-terminal-frame">
                            <div class="skeleton-terminal-dots">
                                <div class="skeleton-dot skeleton-dot-1"></div>
                                <div class="skeleton-dot skeleton-dot-2"></div>
                                <div class="skeleton-dot skeleton-dot-3"></div>
                            </div>
                            <div class="skeleton-terminal-inner">
                                <div class="terminal-container" style="height: 472px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Loading overlay on top of skeleton -->
        <div class="loading-overlay">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading Spectre.Console Playground...</div>
        </div>
    </div>

    <!-- BlazorMonaco -->
    <script src="_content/BlazorMonaco/lib/monaco-editor/min/vs/loader.js"></script>
    <script src="js/editor.js"></script>
    <script>
        console.log('[page] Loading Monaco editor...');
        require.config({ paths: { 'vs': '_content/BlazorMonaco/lib/monaco-editor/min/vs' } });
        require(['vs/editor/editor.main'], function() {
            console.log('[page] Monaco editor loaded');
            // Initialize Monaco theme based on current light/dark mode
            if (window.initializeMonacoTheme) {
                window.initializeMonacoTheme();
            }
        });
    </script>
    <script src="_content/BlazorMonaco/jsInterop.js"></script>
    <script>console.log('[page] BlazorMonaco jsInterop loaded');</script>
    <script src="js/urlstate.js"></script>

    <script>console.log('[page] Loading Blazor WASM...');</script>
    <script src="_framework/blazor.webassembly.js" autostart="false"></script>
    <script type="module">
        console.log('[page] Blazor script loaded, starting Blazor...');
        try {
            await Blazor.start({
                configureRuntime: dotnet => {
                    // Workaround for .NET 10 Blazor WASM hang issue (dotnet/runtime#122529)
                    dotnet.withEnvironmentVariable('MONO_INTERPRETER_OPTIONS', '-ssa');
                    console.log('[page] Set MONO_INTERPRETER_OPTIONS=-ssa');
                }
            });
            console.log('[page] Blazor WASM started and ready');
        } catch(err) {
            console.error('[page] Blazor start error:', err);
        }
    </script>

    <script>
        // Mobile menu toggle
        (function() {
            function initMobileMenu() {
                const menuButton = document.getElementById('mobile-menu-button');
                const mobileMenu = document.getElementById('mobile-menu');

                if (!menuButton || !mobileMenu) {
                    setTimeout(initMobileMenu, 100);
                    return;
                }

                menuButton.addEventListener('click', function() {
                    mobileMenu.classList.toggle('open');
                });

                // Close menu when clicking a link
                mobileMenu.querySelectorAll('a').forEach(link => {
                    link.addEventListener('click', () => {
                        mobileMenu.classList.remove('open');
                    });
                });
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initMobileMenu);
            } else {
                initMobileMenu();
            }
        })();

        // Theme toggle (matching main docs site approach)
        (function() {
            function initThemeToggle() {
                const themeToggle = document.getElementById('theme-toggle');

                if (!themeToggle) {
                    setTimeout(initThemeToggle, 100);
                    return;
                }

                themeToggle.addEventListener('click', function() {
                    const isDark = document.documentElement.classList.toggle('dark');
                    localStorage.theme = isDark ? 'dark' : 'light';

                    // Notify Monaco editor of theme change
                    if (window.updateMonacoTheme) {
                        window.updateMonacoTheme(isDark);
                    }
                });
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initThemeToggle);
            } else {
                initThemeToggle();
            }
        })();
    </script>

    <script>
        // Panel resizer functionality
        (function() {
            function initResizer() {
                const resizer = document.getElementById('panel-resizer');
                if (!resizer) {
                    // Retry after Blazor renders the component
                    setTimeout(initResizer, 100);
                    return;
                }

                const container = resizer.parentElement;
                const editorPanel = container.querySelector('.editor-panel');
                const terminalPanel = container.querySelector('.terminal-panel');

                let isResizing = false;

                resizer.addEventListener('mousedown', function(e) {
                    isResizing = true;
                    resizer.classList.add('resizing');
                    document.body.style.cursor = 'col-resize';
                    document.body.style.userSelect = 'none';
                    e.preventDefault();
                });

                document.addEventListener('mousemove', function(e) {
                    if (!isResizing) return;

                    const containerRect = container.getBoundingClientRect();
                    const containerWidth = containerRect.width;
                    const resizerWidth = resizer.offsetWidth;

                    // Calculate new width based on mouse position
                    let newEditorWidth = e.clientX - containerRect.left;

                    // Enforce minimum widths
                    const minWidth = 200;
                    const maxWidth = containerWidth - minWidth - resizerWidth;

                    newEditorWidth = Math.max(minWidth, Math.min(maxWidth, newEditorWidth));

                    editorPanel.style.width = newEditorWidth + 'px';
                });

                document.addEventListener('mouseup', function() {
                    if (isResizing) {
                        isResizing = false;
                        resizer.classList.remove('resizing');
                        document.body.style.cursor = '';
                        document.body.style.userSelect = '';

                        // Trigger resize events for Monaco and xterm
                        window.dispatchEvent(new Event('resize'));
                    }
                });
            }

            // Start initialization when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initResizer);
            } else {
                initResizer();
            }
        })();
    </script>
</body>
</html>
